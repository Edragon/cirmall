<?xml version="1.0" encoding="UTF-8"?>
<mxGraphModel dx="813" dy="603" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" background="#ffffff" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="1ba8213425ae81c0-17" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: right&quot;&gt;&lt;font color=&quot;#ff9933&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;in RAM for faster execution&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1"><mxGeometry x="20" y="10" width="490" height="220" as="geometry"/></mxCell><mxCell id="1ba8213425ae81c0-2" value="&lt;b&gt;zeroCrossISR()&lt;/b&gt;" style="html=1;verticalAlign=bottom;startArrow=circle;startFill=1;endArrow=open;startSize=6;endSize=8;" edge="1" parent="1"><mxGeometry width="80" relative="1" as="geometry"><mxPoint x="80" y="185" as="sourcePoint"/><mxPoint x="230" y="185" as="targetPoint"/></mxGeometry></mxCell><mxCell id="1ba8213425ae81c0-3" value="&lt;b&gt;checkDimState()&lt;/b&gt;" style="html=1;verticalAlign=bottom;startArrow=circle;startFill=1;endArrow=open;startSize=6;endSize=8;" edge="1" parent="1"><mxGeometry width="80" relative="1" as="geometry"><mxPoint x="80" y="80" as="sourcePoint"/><mxPoint x="230" y="80" as="targetPoint"/></mxGeometry></mxCell><mxCell id="1ba8213425ae81c0-4" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;span&gt;Turn off all pins&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;i&gt;zeroCrossed = true;&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;i&gt;ticksAfterZeroCross = 0;&lt;/i&gt;&lt;/div&gt;" style="html=1;" vertex="1" parent="1"><mxGeometry x="230" y="145" width="170" height="60" as="geometry"/></mxCell><mxCell id="1ba8213425ae81c0-5" value="&lt;div style=&quot;text-align: left&quot;&gt;&lt;span&gt;&lt;i&gt;if(zeroCrossed){&lt;/i&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; compare ticks with switch's dim value and&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp; &amp;nbsp; if enough have elapsed, turn the pin high.&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;i&gt;}&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;i&gt;ticksAfterZeroCross++;&lt;/i&gt;&lt;/div&gt;" style="html=1;" vertex="1" parent="1"><mxGeometry x="230" y="30" width="250" height="90" as="geometry"/></mxCell><mxCell id="1ba8213425ae81c0-10" value="&lt;div style=&quot;text-align: center&quot;&gt;&lt;span&gt;&lt;b&gt;Main Loop&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;- Check if needs to fetch from DB&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;- Check if needs to update DB&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;- Print debug information&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;- Delay&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="html=1;" vertex="1" parent="1"><mxGeometry x="540" y="60" width="200" height="120" as="geometry"/></mxCell><mxCell id="1ba8213425ae81c0-11" value="&lt;b&gt;&amp;nbsp; &amp;nbsp;fetchCheckFunc()&lt;/b&gt;" style="html=1;verticalAlign=bottom;startArrow=circle;startFill=1;endArrow=open;startSize=6;endSize=8;" edge="1" parent="1"><mxGeometry width="80" relative="1" as="geometry"><mxPoint x="80" y="280" as="sourcePoint"/><mxPoint x="230" y="280" as="targetPoint"/></mxGeometry></mxCell><mxCell id="1ba8213425ae81c0-12" value="&lt;i&gt;needToFetchDB = true;&lt;/i&gt;" style="html=1;" vertex="1" parent="1"><mxGeometry x="230" y="260" width="170" height="50" as="geometry"/></mxCell><mxCell id="1ba8213425ae81c0-13" value="~15.4Khz" style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;" vertex="1" parent="1"><mxGeometry x="40" y="35" width="70" height="30" as="geometry"/></mxCell><mxCell id="1ba8213425ae81c0-15" value="~120Hz" style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;" vertex="1" parent="1"><mxGeometry x="40" y="140" width="70" height="30" as="geometry"/></mxCell><mxCell id="1ba8213425ae81c0-16" value="~0.5Hz" style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;" vertex="1" parent="1"><mxGeometry x="40" y="240" width="70" height="30" as="geometry"/></mxCell></root></mxGraphModel>